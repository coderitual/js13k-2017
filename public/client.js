!function(){"use strict";var e={hole:"assets/hole.svg",stamp:"assets/stamp.svg",tree:"assets/tree.svg",eye:"assets/eye.svg",stamp2:"assets/stamp2.svg",eye_closed:"assets/eye_closed.svg",heart:"assets/heart.svg",projectile:"assets/projectile.svg",arrow:"assets/arrow.svg",powerup:"assets/powerup.svg"},t=document.createElement("img");t.src=e.hole,t.addEventListener("load",function(){var e=t.width,a=t.height;console.log({width:e,height:a})});var a=document.createElement("img");a.src=e.stamp,a.addEventListener("load",function(){var e=a.width,t=a.height;console.log({width:e,height:t})});var i=document.createElement("img");i.src=e.stamp2,i.addEventListener("load",function(){var e=i.width,t=i.height;console.log({width:e,height:t})});var o=document.createElement("img");o.src=e.tree,o.addEventListener("load",function(){var e=o.width,t=o.height;console.log({width:e,height:t})});var s=document.createElement("img");s.src=e.eye,s.addEventListener("load",function(){var e=s.width,t=s.height;console.log({width:e,height:t})});var r=document.createElement("img");r.src=e.eye_closed,r.addEventListener("load",function(){var e=r.width,t=r.height;console.log({width:e,height:t})});var n=document.createElement("img");n.src=e.powerup,n.addEventListener("load",function(){var e=n.width,t=n.height;console.log({width:e,height:t})});var h=[s,s,s,s,r],d=document.getElementById("canvas"),l=d.getContext("2d"),c={x:d.width/2,y:d.height/2},g=function(){d.width=d.clientWidth,d.height=d.clientHeight,c.x=d.width/2,c.y=d.height/2};window.addEventListener("resize",g),g();var m=void 0,w=0;(m="8080"===window.location.port?io(window.location.hostname+":3000",{upgrade:!1,transports:["websocket"],query:""+new URL(window.location).searchParams}):io({upgrade:!1,transports:["websocket"],query:""+new URL(window.location).searchParams})).on("pong",function(e){w=e});var v=function(e){var t=e.id,a=e.username;return{id:t,username:void 0===a?"":a,x:0,y:0,sx:0,sy:0}},p={me:v("me"),others:new Map};console.log(p);var u={pointer:c,players:p},f=function(e,r,c){l.globalAlpha=1,l.globalCompositeOperation="source-over",l.fillStyle="#2c5b1e",l.fillRect(0,0,d.width,d.height),l.save(),l.translate(d.width/2-s.width/2-e.players.me.x,d.height/2-s.height/2-e.players.me.y),l.drawImage(t,0,0,200,200),l.drawImage(t,300,200,100,100),l.drawImage(n,300,50),l.drawImage(o,20,200),l.drawImage(o,250,300),l.drawImage(o,90,400,246,314),l.globalCompositeOperation="soft-light",l.drawImage(a,-100,-200,500,500),l.drawImage(i,300,200,300,300),l.globalCompositeOperation="source-over",e.players.others.forEach(function(e){l.drawImage(s,e.x-s.width/2,e.y-s.height/2),l.fillStyle="rgba(255, 255, 255, 0.6)",l.font="12px sans-serif",l.textAlign="center",l.shadowColor="black",l.shadowOffsetX=1,l.shadowOffsetY=1,l.shadowBlur=1,l.fillText(e.username,e.x,e.y+15)}),l.restore();var g=h[Math.round(c/500)%5];l.drawImage(g,d.width/2-s.width/2,d.height/2-s.height/2),l.beginPath(),l.arc(e.pointer.x,e.pointer.y,5,0,2*Math.PI,!1),l.fillStyle="rgba(255, 255, 255, 0.5)",l.fill(),l.lineWidth=3,l.strokeStyle="#fff",l.stroke(),l.fillStyle="rgba(255, 255, 255, 1)",l.font="12px sans-serif",l.textAlign="start",l.textBaseline="top",l.fillText("ping: "+w,10,10)},y=function(e,t){var a=e.players;a.me.x+=(a.me.sx-a.me.x)/5,a.me.y+=(a.me.sy-a.me.y)/5,a.others.forEach(function(e){e.x+=(e.sx-e.x)/5,e.y+=(e.sy-e.y)/5})},x=0;window.addEventListener("deviceorientation",function(e){var t=e.beta,a=e.gamma;t>90&&(t=90),-90>t&&(t=-90),t+=90,a+=90,c.x=d.width*a/180,c.y=d.height*t/180,c.cw=d.width,c.ch=d.height,m.emit("c:pointer",c)}),m.on("s:players",function(e){var t=e.me;e.others.forEach(function(e){var t=u.players.others.get(e.id);if(!t)return t=v(e),void u.players.others.set(e.id,t);t.sx=e.x,t.sy=e.y}),u.players.me.sx=t.x,u.players.me.sy=t.y}),function e(t){requestAnimationFrame(e);y(u),f(u,0,t),x=t}(0)}();
